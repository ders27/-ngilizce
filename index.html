<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Çocuklar için İngilizce Kelime Kartları & Test</title>
  <style>
    :root {
      --primary: #8a2be2; /* Daha canlı mor */
      --accent: #ff6347;  /* Domates kırmızısı gibi daha sıcak bir turuncu */
      --bg: linear-gradient(135deg, #f0f8ff, #e6e6fa); /* Açık mavi ve leylak tonlarında degrade arka plan */
      --text: #333;
      --correct: #3cb371; /* Orta deniz yeşili */
      --wrong: #ff4500;   /* Turuncu kırmızı */
      --card-bg: #ffffff; /* Kart arka planı beyaz */
      --button-hover-bg: #ffe0b3; /* Buton hover için açık turuncu */
      --card-border: #4682b4; /* Kart kenarlığı için çelik mavisi */
      --btn-font: 1.6em;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg); color: var(--text);
      padding: 20px 10px; text-align: center;
      transition: background-color .4s ease;
      display: flex; flex-direction: column; align-items: center;
      min-height: 100vh;
      justify-content: center; /* İçeriği dikeyde ortala */
    }
    h1 {
      color: var(--primary);
      font-size: 2.8em; /* Başlığı büyüt */
      margin-bottom: 30px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.15); /* Gölgeyi belirginleştir */
      font-weight: 700; /* Kalınlaştır */
    }
    /* Kartın dış çerçevesi */
    .card-container {
      width: 90vw; max-width: 360px;
      height: 380px; /* Kart yüksekliğini artır (içerik sığması için) */
      perspective: 1000px; /* 3D efekti için */
      margin: 20px auto;
      cursor: pointer;
    }

    /* Kartın çevrilen iç kısmı */
    .card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      text-align: center;
      transition: transform 0.8s; /* Daha yavaş çevirme animasyonu */
      transform-style: preserve-3d;
      border: 5px solid var(--card-border); /* Kalın ve renkli kenarlık */
      border-radius: 20px; /* Daha yuvarlak köşeler */
      background: var(--card-bg); /* Kart arka planı beyaz */
      box-shadow: 0 12px 24px rgba(0,0,0,0.25); /* Daha belirgin gölge */
      user-select: none;
    }

    /* Kart çevrildiğinde */
    .card-container.flipped .card-inner {
      transform: rotateY(180deg);
    }

    /* Kartın ön ve arka yüzleri */
    .card-face {
      position: absolute;
      width: 100%;
      height: 100%;
      -webkit-backface-visibility: hidden; /* Webkit tarayıcılar için arka yüz gizleme */
      backface-visibility: hidden; /* Arka yüzü gizler, çevirme efekti için gerekli */
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center; /* İçeriği ortala */
      padding: 15px;
      box-sizing: border-box; /* Padding'in genişliği etkilememesi için */
      border-radius: 15px; /* Kartın yüzlerine de border-radius uygula */
    }

    .card-front {
      background: var(--card-bg);
    }

    .card-back {
      background: var(--card-bg);
      transform: rotateY(180deg); /* Arka yüzü başlangıçta çevir */
    }

    .card-image {
      max-width: 90%; /* Kart genişliğine sığdır */
      max-height: 200px; /* Maksimum yükseklik */
      object-fit: contain; /* Resmi bozmadan sığdır */
      border-radius: 12px;
      margin-bottom: 15px;
      border: 3px solid var(--accent); /* Daha belirgin çerçeve */
      box-shadow: 0 4px 8px rgba(0,0,0,0.1); /* Görsele gölge */
    }
    .card-text-en, .card-text-tr {
      font-size: 3em;
      font-weight: bold;
      color: var(--primary);
      text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
    }
    /* Resim yüklenemediğinde metin görünümü */
    .card-image.hidden + .card-text-en {
        font-size: 4em; /* Metni büyüt */
    }

    .controls {
      margin-top: 40px;
      display: flex; /* Butonları yan yana sırala */
      flex-wrap: wrap; /* Küçük ekranlarda alta geçsinler */
      justify-content: center; /* Ortala */
      gap: 15px; /* Butonlar arası boşluk */
    }
    button {
      font-size: var(--btn-font); padding: 14px 30px;
      margin: 8px 6px; border: none; border-radius: 12px;
      background: var(--accent); color: #fff;
      cursor: pointer; transition: transform .15s, background .3s, box-shadow .3s;
      box-shadow: 0 6px 12px rgba(0,0,0,0.18);
      font-weight: bold;
      letter-spacing: 0.5px;
    }
    button:hover:not(:disabled) {
      transform: scale(1.05);
      background: #ff7f50;
      box-shadow: 0 8px 16px rgba(0,0,0,0.25);
    }
    button:disabled { opacity: .6; cursor: default; }
    .hide { display: none !important; }

    /* Test Modu Stilleri */
    .question-box {
      width: 90vw; max-width: 360px; min-height: 110px;
      border: 5px solid var(--primary); border-radius: 18px;
      background: #fff; font-size: 2em; font-weight: 700;
      display: flex; align-items: center; justify-content: center;
      padding: 20px; margin-bottom: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .answers {
      display: flex; flex-direction: column; gap: 14px;
      width: 90vw; max-width: 360px; margin-bottom: 24px;
    }
    .answer-btn {
      position: relative; padding: 16px 24px 16px 56px;
      font-size: 1.5em; font-weight: 700; text-align: left;
      width: 100%;
      border: 4px solid var(--primary); border-radius: 14px;
      background: #fff; cursor: pointer;
      transition: background-color .3s, border-color .3s;
      box-shadow: 0 3px 6px rgba(0,0,0,0.1);
    }
    .answer-btn span.letter {
      position: absolute; left: 18px; top: 50%;
      transform: translateY(-50%); width: 42px; height: 42px;
      line-height: 42px; border-radius: 50%;
      background: var(--primary); color: #fff;
      font-size: 1.4em; font-weight: 900;
      display: flex; align-items: center; justify-content: center;
    }
    .answer-btn.correct {
      background: var(--correct); border-color: var(--correct); color: #fff;
    }
    .answer-btn.wrong {
      background: var(--wrong); border-color: var(--wrong); color: #fff;
    }
    .answer-btn.disabled { pointer-events: none; opacity: .8; }
    #scoreDisplay {
      font-size: 1.6em; color: var(--primary);
      margin-bottom: 20px; font-weight: 700;
    }

    @media (max-width: 600px) {
      body { padding: 10px; }
      h1 { font-size: 2.2em; margin-bottom: 20px; }
      .card-container { height: 350px; padding: 15px; border-radius: 15px; }
      .card-image { max-width: 95%; max-height: 150px; margin-bottom: 10px; }
      .card-text-en, .card-text-tr { font-size: 2.5em; }
      .card-image.hidden + .card-text-en { font-size: 3em; }
      .controls { margin-top: 25px; gap: 10px; }
      button { padding: 10px 20px; font-size: 1em; margin: 5px; }
      .question-box { font-size: 1.8em; padding: 15px; max-width: 95%; }
      .answers button { font-size: 1.2em; padding: 12px; width: 90%; margin: 10px auto; }
      #scoreDisplay { font-size: 1.4em; margin-top: 15px; }
    }
  </style>
</head>
<body>

  <h1>İngilizce Kelime Kartları</h1>

  <div class="card-container" id="cardContainer">
    <div class="card-inner">
      <div class="card-face card-front">
        <img class="card-image" id="cardImage" src="" alt="Kelime Görseli" />
        <div class="card-text-en" id="cardTextEn">Yükleniyor...</div>
      </div>
      <div class="card-face card-back">
        <div class="card-text-tr" id="cardTextTr"></div>
      </div>
    </div>
  </div>
  <div class="controls" id="cardControls">
    <button id="prevBtn">Önceki</button>
    <button id="nextBtn">Sonraki</button>
    <button id="testBtn">Teste Geç</button>
  </div>

  <div id="testArea" class="hide">
    <h2>20 Soruluk Kelime Testi</h2>
    <div class="question-box" id="question">Hazırlanıyor...</div>
    <div class="answers" id="answers"></div>
    <div id="scoreDisplay">Puan: 0</div>
    <button id="backToCardsBtn">Kartlara Geri Dön</button>
  </div>

  <script>
    const words = [
      {en:"Hello", tr:"Merhaba"}, {en:"Goodbye", tr:"Hoşça kal"},
      {en:"Please", tr:"Lütfen"}, {en:"Thank you", tr:"Teşekkür ederim"},
      {en:"Sorry", tr:"Özür dilerim"}, {en:"Yes", tr:"Evet"},
      {en:"No", tr:"Hayır"}, {en:"Welcome", tr:"Hoş geldin"},
      {en:"Excuse me", tr:"Afedersiniz"}, {en:"OK", tr:"Tamam"},
      {en:"Mother", tr:"Anne"}, {en:"Father", tr:"Baba"},
      {en:"Sister", tr:"Kız kardeş"}, {en:"Brother", tr:"Erkek kardeş"},
      {en:"Friend", tr:"Arkadaş"}, {en:"Baby", tr:"Bebek"},
      {en:"Girl", tr:"Kız"}, {en:"Boy", tr:"Erkek"},
      {en:"Family", tr:"Aile"}, {en:"People", tr:"İnsanlar"},
      {en:"House", tr:"Ev"}, {en:"Room", tr:"Oda"},
      {en:"Bed", tr:"Yatak"}, {en:"Table", tr:"Masa"},
      {en:"Chair", tr:"Sandalye"}, {en:"Door", tr:"Kapı"},
      {en:"Window", tr:"Pencere"}, {en:"TV", tr:"Televizyon"},
      {en:"Lamp", tr:"Lamba"}, {en:"Carpet", tr:"Halı"},
      {en:"School", tr:"Okul"}, {en:"Teacher", tr:"Öğretmen"},
      {en:"Student", tr:"Öğrenci"}, {en:"Book", tr:"Kitap"},
      {en:"Pen", tr:"Tükenmez kalem"}, {en:"Pencil", tr:"Kurşun kalem"},
      {en:"Bag", tr:"Çanta"}, {en:"Ruler", tr:"Cetvel"},
      {en:"Eraser", tr:"Silgi"}, {en:"Board", tr:"Tahta"},
      {en:"Dog", tr:"Köpek"}, {en:"Cat", tr:"Kedi"},
      {en:"Bird", tr:"Kuş"}, {en:"Fish", tr:"Balık"},
      {en:"Cow", tr:"İnek"}, {en:"Horse", tr:"At"},
      {en:"Duck", tr:"Ördek"}, {en:"Lion", tr:"Aslan"},
      {en:"Elephant", tr:"Fil"}, {en:"Monkey", tr:"Maymun"},
      {en:"Apple", tr:"Elma"}, {en:"Banana", tr:"Muz"},
      {en:"Bread", tr:"Ekmek"}, {en:"Water", tr:"Su"},
      {en:"Milk", tr:"Süt"}, {en:"Egg", tr:"Yumurta"},
      {en:"Cheese", tr:"Peynir"}, {en:"Meat", tr:"Et"},
      {en:"Rice", tr:"Pirinç"}, {en:"Cake", tr:"Kek"},
      {en:"Red", tr:"Kırmızı"}, {en:"Blue", tr:"Mavi"},
      {en:"Green", tr:"Yeşil"}, {en:"Yellow", tr:"Sarı"},
      {en:"Black", tr:"Siyah"}, {en:"White", tr:"Beyaz"},
      {en:"Orange", tr:"Turuncu"}, {en:"Pink", tr:"Pembe"},
      {en:"Brown", tr:"Kahverengi"}, {en:"Purple", tr:"Mor"},
      {en:"One", tr:"Bir"}, {en:"Two", tr:"İki"},
      {en:"Three", tr:"Üç"}, {en:"Four", tr:"Dört"},
      {en:"Five", tr:"Beş"}, {en:"Day", tr:"Gün"},
      {en:"Night", tr:"Gece"}, {en:"Morning", tr:"Sabah"},
      {en:"Evening", tr:"Akşam"}, {en:"Today", tr:"Bugün"},
      {en:"Shirt", tr:"Gömlek"}, {en:"Pants", tr:"Pantolon"},
      {en:"Dress", tr:"Elbise"}, {en:"Skirt", tr:"Etek"},
      {en:"Shoes", tr:"Ayakkabı"}, {en:"Socks", tr:"Çorap"},
      {en:"Hat", tr:"Şapka"}, {en:"Jacket", tr:"Ceket"},
      {en:"Coat", tr:"Kaban"}, {en:"T-shirt", tr:"Tişört"},
      {en:"Head", tr:"Kafa"}, {en:"Hair", tr:"Saç"},
      {en:"Eye", tr:"Göz"}, {en:"Nose", tr:"Burun"},
      {en:"Mouth", tr:"Ağız"}, {en:"Ear", tr:"Kulak"},
      {en:"Hand", tr:"El"}, {en:"Arm", tr:"Kol"},
      {en:"Leg", tr:"Bacak"}, {en:"Foot", tr:"Ayak"}
    ];

    let currentIndex = 0, quiz = [], qIndex = 0, score = 0, questionIsEnglish;

    // Yeni DOM element referansları
    const cardContainer = document.getElementById('cardContainer');
    const cardImage     = document.getElementById('cardImage');
    const cardTextEn    = document.getElementById('cardTextEn');
    const cardTextTr    = document.getElementById('cardTextTr'); // Türkçe anlamı için
    const prevBtn       = document.getElementById('prevBtn');
    const nextBtn       = document.getElementById('nextBtn');
    const testBtn       = document.getElementById('testBtn');
    const cardControls  = document.getElementById('cardControls');
    const testArea      = document.getElementById('testArea');
    const questionBox   = document.getElementById('question');
    const answersBox    = document.getElementById('answers');
    const scoreDisplay  = document.getElementById('scoreDisplay');
    const backBtn       = document.getElementById('backToCardsBtn');
    const body          = document.body;

    // Her kelime için görsel URL'i oluşturma ve kelime objesine ekleme
    const processedWords = words.map(word => ({
      ...word,
      // Unsplash'ten daha iyi sonuçlar için 'random' ve 'concept' anahtar kelimesi
      img: `https://source.unsplash.com/random/400x300/?${encodeURIComponent(word.en.toLowerCase())},cartoon,illustration,concept`
    }));

    function renderCard() {
      const w = processedWords[currentIndex]; // processedWords'u kullanıyoruz

      // Kart çevrilmişse ön yüze dönmesini sağla
      cardContainer.classList.remove('flipped');

      cardTextEn.textContent = w.en;
      cardTextTr.textContent = w.tr; // Türkçe anlamı arka yüze yerleştir

      // Resim yüklenemediğinde veya hata verdiğinde alternatif metin gösterimi
      cardImage.onerror = () => {
        cardImage.classList.add('hidden'); // Resmi gizle (CSS ile display: none)
        cardImage.style.display = 'none'; // Direkt gizle
        cardTextEn.style.fontSize = '4em'; // İngilizce metni büyüt
        cardTextEn.textContent = w.en + " (Resim Yüklenemedi)"; // Hata mesajı ekle
        console.warn(`Resim yüklenemedi: ${w.img} - Kelime: ${w.en}`);
      };

      // Resim başarıyla yüklendiğinde eski haline getir
      cardImage.onload = () => {
        cardImage.classList.remove('hidden'); // Resmi göster
        cardImage.style.display = 'block'; // Direkt göster
        cardTextEn.style.fontSize = '3em'; // İngilizce metin boyutunu normale döndür
        cardTextEn.textContent = w.en; // Hata mesajını kaldır
      };

      // Resim URL'sini ata ve yüklemeyi tetikle
      // Eğer bir önceki resim de yüklenememişse, onerror tekrar tetiklenmeyebilir.
      // Bu yüzden src'yi her zaman yenilemek iyi bir uygulama.
      cardImage.src = w.img;
    }

    // Kartın tıklanma olayı (çevirme için)
    cardContainer.onclick = () => {
      cardContainer.classList.toggle('flipped');
    };


    prevBtn.onclick = () => {
      currentIndex = (currentIndex - 1 + processedWords.length) % processedWords.length;
      renderCard();
    };

    nextBtn.onclick = () => {
      currentIndex = (currentIndex + 1) % processedWords.length;
      renderCard();
    };

    testBtn.onclick = () => {
      quiz = shuffle([...processedWords]).slice(0,20); // processedWords'u kullanıyoruz
      qIndex = 0; score = 0;
      cardControls.classList.add('hide');
      cardContainer.classList.add('hide'); // Kartı gizle
      testArea.classList.remove('hide');
      loadQuestion(); updateScore();
    };

    backBtn.onclick = () => {
      testArea.classList.add('hide');
      cardControls.classList.remove('hide');
      cardContainer.classList.remove('hide'); // Kartı göster
      renderCard();
      body.style.backgroundColor = 'var(--bg)';
    };

    function loadQuestion() {
      clearFeedback();
      answersBox.innerHTML = '';
      if (qIndex >= quiz.length) {
        questionBox.textContent = `Test tamamlandı! Puan: ${score}/${quiz.length}`;
        scoreDisplay.textContent = '';
        return;
      }
      updateScore();
      questionIsEnglish = Math.random() < 0.5; // Sorunun İngilizce mi Türkçe mi olacağını rastgele seç
      const correct = quiz[qIndex];
      questionBox.textContent = questionIsEnglish ? correct.en : correct.tr;

      const opts = [correct];
      const availableWordsForOptions = processedWords.filter(word => word.en !== correct.en); // Doğru kelimeyi seçeneklerden çıkar

      while (opts.length < 4 && availableWordsForOptions.length > 0) {
        const randomIndex = Math.floor(Math.random() * availableWordsForOptions.length);
        const randomWord = availableWordsForOptions[randomIndex];
        if (!opts.some(opt => opt.en === randomWord.en)) { // Aynı kelimenin birden fazla kez eklenmesini engelle
            opts.push(randomWord);
            availableWordsForOptions.splice(randomIndex, 1); // Seçilen kelimeyi tekrar seçmemek için kaldır
        }
      }
      shuffle(opts).forEach((opt, i) => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.innerHTML = `<span class="letter">${String.fromCharCode(65+i)}</span>` +
                        (questionIsEnglish ? opt.tr : opt.en); // Sorunun diline göre cevap metnini ayarla
        btn.onclick = () => selectAnswer(btn, opt, correct);
        answersBox.appendChild(btn);
      });
    }

    function selectAnswer(btn, sel, corr) {
      playSound(sel === corr ? 'correct' : 'wrong');
      body.style.backgroundColor = sel === corr ? 'var(--correct)' : 'var(--wrong)';
      if (sel === corr) { btn.classList.add('correct'); score++; }
      else {
        btn.classList.add('wrong');
        Array.from(answersBox.children).forEach(b => {
          // Doğru cevabı bul ve işaretle
          const correctText = questionIsEnglish ? corr.tr : corr.en;
          if (b.textContent.includes(correctText) && !b.classList.contains('wrong')) {
            b.classList.add('correct');
          }
        });
      }
      // Tüm cevap butonlarını devre dışı bırak
      Array.from(answersBox.children).forEach(b => {
        b.disabled = true;
        b.classList.add('disabled');
      });
      updateScore();
      setTimeout(() => {
        qIndex++; loadQuestion(); body.style.backgroundColor = 'var(--bg)';
      }, 1500);
    }

    function updateScore() {
      // Test tamamlandığında veya kelime sayısı 0 olduğunda soru sayısını gösterme
      if (qIndex >= quiz.length || quiz.length === 0) {
        scoreDisplay.textContent = `Puan: ${score}/${quiz.length}`;
      } else {
        scoreDisplay.textContent = `Puan: ${score}/${quiz.length}  Soru: ${qIndex + 1}/${quiz.length}`;
      }
    }

    function playSound(type) {
      if (!window.audioCtx) window.audioCtx = new (AudioContext||webkitAudioContext)();
      const ctx = window.audioCtx;
      const o = ctx.createOscillator(), g = ctx.createGain();
      o.connect(g); g.connect(ctx.destination);
      o.frequency.value = type==='correct' ? 220 : 880; // Doğru: Kalın (220 Hz), Yanlış: İnce (880 Hz)
      g.gain.setValueAtTime(0.3, ctx.currentTime);
      o.start(ctx.currentTime); o.stop(ctx.currentTime+0.3);
    }

    function clearFeedback() {
      body.style.backgroundColor = 'var(--bg)';
    }

    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    // Sayfa yüklendiğinde ilk kartı göster
    window.addEventListener('DOMContentLoaded', renderCard);
  </script>

</body>
</html>
